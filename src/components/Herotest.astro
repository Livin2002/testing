<div class="hero-slider" data-carousel>
  <div
    class="carousel-cell"
    style="background-image:url(https://78.media.tumblr.com/469798be38e86cc01ea4ba08563af785/tumblr_p38kazKBIX1snegd3o1_1280.jpg);"
  >
    <div class="overlay"></div>
    <div class="slide-content">
      <div class="mask">
        <h2 class="title">Slide 1</h2>
      </div>
      <div class="divider"></div>
      <div class="mask">
        <p class="caption">Flickity is fun to use.</p>
        <a href="https://flickity.metafizzy.co/" target="_blank" class="btn"
          >Tell me more</a
        >
      </div>
    </div>
  </div>
  <div
    class="carousel-cell"
    style="background-image:url(https://78.media.tumblr.com/f3577e640674f66119dad5ce61b4582c/tumblr_ozf8vw9LYN1snegd3o1_1280.jpg);"
  >
    <div class="overlay"></div>
    <div class="slide-content">
      <div class="mask">
        <h2 class="title">Slide 2</h2>
      </div>
      <div class="divider"></div>
      <div class="mask">
        <p class="caption">Flickity is flexible.</p>
        <a href="https://flickity.metafizzy.co/" target="_blank" class="btn"
          >Tell me more</a
        >
      </div>
    </div>
  </div>
  <div
    class="carousel-cell"
    style="background-image:url(https://78.media.tumblr.com/895918f98ebb3644e885f663bf63ba61/tumblr_pa4fmzV4kV1snegd3o1_1280.jpg);"
  >
    <div class="overlay"></div>
    <div class="slide-content">
      <div class="mask">
        <h2 class="title">Slide 3</h2>
      </div>
      <div class="divider"></div>
      <div class="mask">
        <p class="caption">Flickity is awesome.</p>
        <a href="https://flickity.metafizzy.co/" target="_blank" class="btn"
          >Tell me more</a
        >
      </div>
    </div>
  </div>
</div>

<style>
  .overlay {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(
      to bottom,
      transparentize(#0e1d33, 0.2),
      transparentize(#0e1d33, 0.8)
    );
  }

  .hero-slider {
    width: 100%;
    height: 100vh;
    overflow: hidden;

    .carousel-cell {
      width: 100%;
      height: 100%;
      background-repeat: no-repeat;
      background-size: cover;
      background-position: center;

      .slide-content {
        position: relative;
        top: 50%;
        transform: translateY(-50%);
        text-align: center;

        .title {
          position: relative;
          font-family: $font-family-primary;
          font-size: 3.2rem;
          letter-spacing: 3px;
          text-transform: uppercase;
          color: #ffffff;
        }

        .caption {
          font-family: $font-family-secondary;
          font-size: 2.2rem;
          color: #ffffff;
          margin-bottom: 30px;
        }

        .btn {
          display: inline-block;
          border: 1px solid #fff;
          padding: 14px 18px;
          text-transform: uppercase;
          font-family: $font-family-secondary;
          font-size: 0.9rem;
          letter-spacing: 2px;
          color: #fff;
          text-decoration: none;

          &:hover {
            background: #fff;
            color: #000;
            transition: all 0.2s ease;
          }
        }
      }
    }

    .flickity-prev-next-button {
      width: 80px;
      height: 80px;
      background: transparent;

      &:hover {
        background: transparent;
      }

      .arrow {
        fill: white;
      }
    }

    .flickity-page-dots {
      bottom: 30px;

      .dot {
        width: 30px;
        height: 4px;
        opacity: 1;
        background: rgba(255, 255, 255, 0.5);
        border: 0 solid white;
        border-radius: 0;

        &.is-selected {
          background: #ff0000;
          border: 0 solid #ff0000;
        }
      }
    }
  }

  /* --------------------------------
Masking
-------------------------------- */
  .slide-content {
    .title,
    .caption,
    .btn {
      position: relative;
      opacity: 0;
      animation-fill-mode: forwards;
    }
  }

  .slide-content.mask {
    .mask {
      position: relative;
      overflow: hidden;
    }

    .title {
      animation-duration: 0.4s;
      animation-delay: 0.7s;
      animation-name: slide-up;
      animation-fill-mode: backwards;
      opacity: 1;
    }

    .divider {
      display: inline-block;
      position: relative;
      margin: 5px auto;
      height: 2px;
      width: 60%;
      background-color: #ffffff;
      animation: divider-mask 1s 0.3s both;
    }

    .caption,
    .btn {
      animation-duration: 0.4s;
      animation-delay: 0.7s;
      animation-name: slide-down;
    }
  }

  @-webkit-keyframes slide-up {
    0% {
      opacity: 0;
      -webkit-transform: translateY(100%);
    }

    100% {
      opacity: 1;
      -webkit-transform: translateY(0);
    }
  }

  @-moz-keyframes slide-up {
    0% {
      opacity: 0;
      -moz-transform: translateY(100%);
    }

    100% {
      opacity: 1;
      -moz-transform: translateY(0);
    }
  }

  @keyframes slide-up {
    0% {
      opacity: 0;
      transform: translateY(100%);
    }

    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @-webkit-keyframes slide-down {
    0% {
      opacity: 0;
      -webkit-transform: translateY(-100%);
    }

    100% {
      opacity: 1;
      -webkit-transform: translateY(0);
    }
  }

  @-moz-keyframes slide-down {
    0% {
      opacity: 0;
      -moz-transform: translateY(-100%);
    }

    100% {
      opacity: 1;
      -moz-transform: translateY(0);
    }
  }

  @keyframes slide-down {
    0% {
      opacity: 0;
      transform: translateY(-100%);
    }

    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @-webkit-keyframes divider-mask {
    0%,
    100% {
      transform: scaleX(0);
    }

    40%,
    60% {
      -webkit-transform: scaleX(1);
    }
  }

  @-moz-keyframes divider-mask {
    0%,
    100% {
      transform: scaleX(0);
    }

    40%,
    60% {
      -moz-transform: scaleX(1);
    }
  }

  @keyframes divider-mask {
    0%,
    100% {
      transform: scaleX(0);
    }

    40%,
    60% {
      transform: scaleX(1);
    }
  }
</style>

<script is:inline>
  var options = {
    accessibility: true,
    prevNextButtons: true,
    pageDots: true,
    setGallerySize: false,
    arrowShape: {
      x0: 10,
      x1: 60,
      y1: 50,
      x2: 60,
      y2: 45,
      x3: 15,
    },
  };

  var $carousel = $("[data-carousel]").flickity(options);
  var $slideContent = $(".slide-content");
  var flkty = $carousel.data("flickity");
  var selectedSlide = flkty.selectedElement;

  flkty.on("settle", function (index) {
    selectedSlide = flkty.selectedElement;
  });

  flkty.on("change", function (index) {
    $slideContent.eq(index).removeClass("mask");

    setTimeout(function () {
      $slideContent.addClass("mask");
    }, 500);
  });

  flkty.on("dragStart", function (event) {
    var index = 0;
    selectedSlide = flkty.selectedElement;

    if (event.layerX > 0) {
      // direction right
      index = $(selectedSlide).index() + 1;
    } else {
      // direction left
      index = $(selectedSlide).index() - 1;
    }

    $slideContent.eq(index).removeClass("mask");
  });

  setTimeout(function () {
    $slideContent.addClass("mask");
  }, 500);
</script>
